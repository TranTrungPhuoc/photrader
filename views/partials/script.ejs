<script src="/assets/js/vendor-all.min.js"></script>
<script src="/assets/js/plugins/bootstrap.min.js"></script>
<script src="/assets/js/ripple.js"></script>
<script src="/assets/js/pcoded.min.js"></script>
<script>
    function status(id) {
        const status = $('#switch-'+id).prop('checked')
        $.ajax({
            url: '/admin/<%-module%>/status',
            type: 'POST',
            data: {id, status},
            success: function(results){} 
        })
    }
    function popupDelete(id,name) {
        $('#deleteText').text(name)
        $('#deleteId').val(id)
    }
    function deleteRow() {
        const id =$('#deleteId').val()
        $.ajax({
            url: '/admin/<%-module%>/delete',
            type: 'POST',
            data: {id},
            success: function(results){
                $('.loading').hide()
                $('#tr_'+id).remove()
            } 
        })
    }
    $(document).ready(function(){
        $('#formData').on('submit', function(e){
            e.preventDefault()
            const array = $('form').serializeArray()
            const data = {}
            for (let index = 0; index < array.length; index++) {
                data[array[index].name] = array[index].value
            }
            const id=$('#idEdit').val()
            $.ajax({
                url: '/admin/<%-module%>/process?id='+id,
                type: 'POST',
                beforeSend: function(){ $('.loading').show() },
                data, success: function(results){
                    $('.loading').hide()
                    if(results.length == 0){
                        if(window.location.pathname.includes('add')){
                            alert('Thêm thành công !!!')
                            window.location.href = '/admin/<%-module%>/index'
                        }
                    }else{
                        for (let index = 0; index < results.length; index++) {
                            const key = $('.error_'+results[index]['key']);
                            key.text(results[index]['error'])
                        }
                    }
                } 
            })
        })
    })
</script>